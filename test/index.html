<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon"> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/qunit-theme-ninja@2.0.0/qunit.css"></link>
  <title>Unit testing</title>
</head>
<body>

  <h2>UNIT TESTING</h2>

  <div id="screen"></div>
  <canvas width="1" height="1"></canvas>
  <canvas width="1" height="1"></canvas>
  <canvas width="1" height="1"></canvas>
  <canvas width="1" height="1"></canvas>
  <canvas width="1" height="1"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/dat.gui@0.7.6/build/dat.gui.min.js"></script>
  <script>
    let settings = {
      count: 1000000,
      'unit testing': () => window.location.replace("./index.html"),
      'cpu': () => window.location.replace("../examples/cpu.html"),
      'webgl': () => window.location.replace("../examples/webgl.html"),
      'webgl2': () => window.location.replace("../examples/webgl2.html"),
      'named measures': () => window.location.replace("../examples/named-measures.html"),
      'new loggers': () => window.location.replace("../examples/new-loggers.html"),
      'with statsJs ui': () => window.location.replace("../examples/with-statsJs-ui.html"),
    };
    let gui = new dat.GUI();
    let ut = gui.addFolder('Unit testing')
    ut.add(settings, 'unit testing');
    let it = gui.addFolder('E2E testing');
    it.add(settings, 'cpu');
    it.add(settings, 'webgl');
    it.add(settings, 'webgl2');
    it.add(settings, 'named measures');
    it.add(settings, 'new loggers');
    it.add(settings, 'with statsJs ui');
    gui.add(settings, 'count', 10000, 5000000);
    ut.open();
    it.open();

    const addSniffer = (spyTarget) => function() {
      spyTarget.apply(window.console, arguments);
      sniffer([...arguments]);
    }
    window.console.log = addSniffer(window.console.log);
    window.console.error = addSniffer(window.console.error);

    let screen = document.getElementById('screen');
    function sniffer(string) {
      let screen = document.getElementById("screen");
      string.forEach(line => {
        let div = document.createElement("div");
        let text = document.createTextNode(line);
        div.appendChild(text)
        screen.appendChild(div);
      });
    }
  </script>
  <script type="module" src="./test.js"></script>
</body>
</html>