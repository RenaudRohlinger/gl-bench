'use strict';var GlBench=function(){function e(){if(void 0===this.gpuFrames)this.queries=[this.gl.createQuery()],this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,this.queries[0]),this.gpuFrames=0,this.nanosecs=[],this.duration=0;else{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT);if(!this.gl.getParameter(this.ext.GPU_DISJOINT_EXT))for(let b=this.gpuFrames;b<this.queries.length&&this.gl.getQueryParameter(this.queries[b],this.gl.QUERY_RESULT_AVAILABLE);b++){this.gpuFrames++;var a=this.gl.getQueryParameter(this.queries[b],
this.gl.QUERY_RESULT);this.nanosecs.push(a);this.duration+=a;a=this.duration/1E9;if(1<=a){let c=this.gpuFrames/a;for(;1<=a;)this.fpsLogger(c),a--;for(a=0;a<b+1;a++)this.gl.deleteQuery(this.queries[a]);this.queries.splice(0,b+1);this.nanosecs.splice(0,b+1);this.duration=this.gpuFrames=0}}this.queries.push(this.gl.createQuery());this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,this.queries[this.queries.length-1])}}function f(){void 0===this.startCounter&&(this.startCounter=[],this.finishCounter=[]);this.startCounter.push(this.gl.createQuery());
this.finishCounter.push(this.gl.createQuery());this.ext.queryCounterEXT(this.startCounter[this.startCounter.length-1],this.ext.TIMESTAMP_EXT)}function g(){this.ext.queryCounterEXT(this.finishCounter[this.finishCounter.length-1],this.ext.TIMESTAMP_EXT)}function d(){return(window.performance||Date).now()}function h(){if(void 0===this.frames)this.frames=0,this.prevTime=d();else{this.frames++;let a=d();this.ms=a-this.prevTime;let b=this.ms/1E3;if(1<=b){let c=this.frames/b;for(;1<=b;)this.fpsLogger(c),
b--;this.frames=0;this.prevTime=a}}}function k(){this.counterBegin=d()}function l(){void 0===this.prevframes?this.counterDuration=0:0===this.frames?(this.counterLogger(this.counterDuration/this.ms),this.counterDuration=0):this.counterDuration+=d()-this.counterBegin;this.prevframes=this.frames}class m{constructor(a,b){this.fpsLogger="function"==typeof a?a:null;this.counterLogger="function"==typeof a?b:null}initCanvas(a){if(!a){let b=document.getElementsByTagName("canvas");for(let c=0;c<b.length;c++)if(0==
c||a.width*a.height<b[c].width*b[c].height)a=b[c]}a&&"function"==typeof a.getContext?(this.gl=a.getContext("webgl")||a.getContext("experimental-webgl"))?(this.ext=this.gl.getExtension("EXT_disjoint_timer_query"),this.gl.createQuery=this.ext.createQueryEXT.bind(this.ext),this.gl.deleteQuery=this.ext.deleteQueryEXT.bind(this.ext),this.gl.beginQuery=this.ext.beginQueryEXT.bind(this.ext),this.gl.endQuery=this.ext.endQueryEXT.bind(this.ext),this.gl.getQueryParameter=this.ext.getQueryObjectEXT.bind(this.ext),
this.gl.QUERY_RESULT_AVAILABLE=this.ext.QUERY_RESULT_AVAILABLE_EXT,this.gl.QUERY_RESULT=this.ext.QUERY_RESULT_EXT):this.ext=(this.gl=a.getContext("webgl2"))?this.gl.getExtension("EXT_disjoint_timer_query_webgl2"):null:console.log("CPU fallback");this.inited=!0}update(){this.ext?e.bind(this)():this.inited?h.bind(this)():(this.initCanvas(),this.update())}begin(){this.ext?f.bind(this)():this.inited?k.bind(this)():(this.initCanvas(),this.begin())}end(){this.ext?g.bind(this)():this.inited&&l.bind(this)()}}
return m}();
