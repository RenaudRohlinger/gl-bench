import 'dns';

var UISVG = "<div class=\"gl-box\">\n  <svg viewBox=\"0 0 55 60\">\n    <text x=\"27\" y=\"56\" class=\"gl-fps\">00 FPS</text>\n    <text x=\"28\" y=\"8\" class=\"gl-mem\"></text>\n    <rect x=\"0\" y=\"14\" rx=\"4\" ry=\"4\" width=\"55\" height=\"32\"></rect>\n    <polyline class=\"gl-chart\"></polyline>\n  </svg>\n  <svg viewBox=\"0 0 14 60\" class=\"gl-cpu-svg\">\n    <line x1=\"7\" y1=\"38\" x2=\"7\" y2=\"11\" class=\"opacity\"/>\n    <line x1=\"7\" y1=\"38\" x2=\"7\" y2=\"11\" class=\"gl-cpu\" stroke-dasharray=\"0 27\"/>\n    <path d=\"M5.35 43c-.464 0-.812.377-.812.812v1.16c-.783.1972-1.421.812-1.595 1.624h-1.16c-.435 0-.812.348-.812.812s.348.812.812.812h1.102v1.653H1.812c-.464 0-.812.377-.812.812 0 .464.377.812.812.812h1.131c.1943.783.812 1.392 1.595 1.595v1.131c0 .464.377.812.812.812.464 0 .812-.377.812-.812V53.15h1.653v1.073c0 .464.377.812.812.812.464 0 .812-.377.812-.812v-1.131c.783-.1943 1.392-.812 1.595-1.595h1.131c.464 0 .812-.377.812-.812 0-.464-.377-.812-.812-.812h-1.073V48.22h1.102c.435 0 .812-.348.812-.812s-.348-.812-.812-.812h-1.16c-.1885-.783-.812-1.421-1.595-1.624v-1.131c0-.464-.377-.812-.812-.812-.464 0-.812.377-.812.812v1.073H6.162v-1.073c0-.464-.377-.812-.812-.812zm.58 3.48h2.088c.754 0 1.363.609 1.363 1.363v2.088c0 .754-.609 1.363-1.363 1.363H5.93c-.754 0-1.363-.609-1.363-1.363v-2.088c0-.754.609-1.363 1.363-1.363z\"/>\n  </svg>\n  <svg viewBox=\"0 0 14 60\" class=\"gl-gpu-svg\">\n    <line x1=\"7\" y1=\"38\" x2=\"7\" y2=\"11\" class=\"opacity\"/>\n    <line x1=\"7\" y1=\"38\" x2=\"7\" y2=\"11\" class=\"gl-gpu\" stroke-dasharray=\"0 27\"/>\n    <path d=\"M1.94775 43.3772a.736.736 0 10-.00416 1.472c.58535.00231.56465.1288.6348.3197.07015.18975.04933.43585.04933.43585l-.00653.05405v8.671a.736.736 0 101.472 0v-1.4145c.253.09522.52785.1495.81765.1495h5.267c1.2535 0 2.254-.9752 2.254-2.185v-3.105c0-1.2075-1.00625-2.185-2.254-2.185h-5.267c-.28865 0-.5635.05405-.8165.1495.01806-.16445.04209-.598-.1357-1.0787-.22425-.6072-.9499-1.2765-2.0125-1.2765zm2.9095 3.6455c.42435 0 .7659.36225.7659.8119v2.9785c0 .44965-.34155.8119-.7659.8119s-.7659-.36225-.7659-.8119v-2.9785c0-.44965.34155-.8119.7659-.8119zm4.117 0a2.3 2.3 0 012.3 2.3 2.3 2.3 0 01-2.3 2.3 2.3 2.3 0 01-2.3-2.3 2.3 2.3 0 012.3-2.3z\"/>\n  </svg>\n</div>";

var UICSS = "#gl-bench {\n  position:absolute;\n  left:0;\n  top:0;\n  z-index:1000;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n}\n\n#gl-bench div {\n  position: relative;\n  display: block;\n  margin: 4px;\n  padding: 0 7px 0 10px;\n  background: #6c6;\n  border-radius: 15px;\n  cursor: pointer;\n  opacity: 0.9;\n}\n\n#gl-bench svg {\n  height: 60px;\n  margin: 0 -1px;\n}\n\n#gl-bench text {\n  font-size: 12px;\n  font-family: Helvetica,Arial,sans-serif;\n  font-weight: 700;\n  dominant-baseline: middle;\n  text-anchor: middle;\n}\n\n#gl-bench .gl-mem {\n  font-size: 9px;\n}\n\n#gl-bench line {\n  stroke-width: 5;\n  stroke: #112211;\n  stroke-linecap: round;\n}\n\n#gl-bench polyline {\n  fill: none;\n  stroke: #112211;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n  stroke-width: 3.5;\n}\n\n#gl-bench rect {\n  fill: #448844;\n}\n\n#gl-bench .opacity {\n  stroke: #448844;\n}\n";

class GLBench {

  /** GLBench constructor
   * @param { WebGLRenderingContext | WebGL2RenderingContext } gl context
   * @param { Object | undefined } settings additional settings
   */
  constructor(gl, settings = {}) {
    this.css = UICSS;
    this.svg = UISVG;
    this.paramLogger = () => {};
    this.chartLogger = () => {};
    this.chartLen = 20;
    this.chartHz = 20;

    this.names = [];
    this.cpuAccums = [];
    this.gpuAccums = [];  
    this.activeAccums = [];
    this.chart = new Array(this.chartLen);
    this.now = () => (performance && performance.now) ? performance.now() : Date.now();
    this.updateUI = () => {
      [].forEach.call(this.nodes['gl-gpu-svg'], node => {
        node.style.display = this.trackGPU ? 'inline' : 'none';
      });
    };

    Object.assign(this, settings);
    this.detected = 0;
    this.finished = [];
    this.isFramebuffer = 0;
    this.frameId = 0;

    // 120hz device detection
    let rafId, n = 0, t0;
    let loop = (t) => {
      if (++n < 10) {
        rafId = requestAnimationFrame(loop);
      } else {
        this.detected = Math.ceil(1e3 * n / (t - t0) / 70);
        cancelAnimationFrame(rafId);
      }
      if (!t0) t0 = t;
    };
    requestAnimationFrame(loop);

    // attach gpu profilers
    if (gl) {
      const glFinish = async (t, activeAccums) =>
        Promise.resolve(setTimeout(() => {
          if (this.isFramebuffer) {
            gl.finish();
          } else {
            gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array(4));
          }
          const dt = this.now() - t;
          activeAccums.forEach((active, i) => {
            if (active) this.gpuAccums[i] += dt;
          });
        }, 0));

      const addProfiler = (fn, self, target) => function() {
        const t = self.now();
        fn.apply(target, arguments);
        if (self.trackGPU) {
          self.finished.push(glFinish(t, self.activeAccums.slice(0)));
        }
      };

      ['drawArrays', 'drawElements', 'drawArraysInstanced',
        'drawBuffers', 'drawElementsInstanced', 'drawRangeElements']
        .forEach(fn => { if (gl[fn]) gl[fn] = addProfiler(gl[fn], this, gl); });

      gl.getExtension = ((fn, self) => function() {
        let ext = fn.apply(gl, arguments);
        ['drawElementsInstancedANGLE', 'drawBuffersWEBGL']
          .forEach(fn => { if (ext[fn]) ext[fn] = addProfiler(ext[fn], self, ext); });
        return ext;
      })(gl.getExtension, this);

      gl.bindFramebuffer = ((fn, target, self) => function() {
        fn.apply(target, arguments);
        self.isFramebuffer = !arguments[1];
      })(gl.bindFramebuffer, gl, this);
    }

    // init ui and ui loggers
    if (!this.withoutUI) {
      if (!this.dom) this.dom = document.body;
      let elm = document.createElement('div');
      elm.id = 'gl-bench';
      this.dom.appendChild(elm);
      this.dom.insertAdjacentHTML('afterbegin', '<style id="gl-bench-style">' + this.css + '</style>');
      this.dom = elm;
      this.dom.addEventListener('click', () => {
        this.trackGPU = !this.trackGPU;
        this.updateUI();
      });

      this.paramLogger = ((logger, dom, names) => {
        const classes = ['gl-cpu', 'gl-gpu', 'gl-mem', 'gl-fps', 'gl-gpu-svg', 'gl-chart'];
        const nodes = Object.assign({}, classes);
        classes.forEach(c => nodes[c] = dom.getElementsByClassName(c));
        this.nodes = nodes;
        return (i, cpu, gpu, mem, fps, totalTime, frameId) => {
          nodes['gl-cpu'][i].style.strokeDasharray = (cpu * 0.27).toFixed(0) + ' 100';
          nodes['gl-gpu'][i].style.strokeDasharray = (gpu * 0.27).toFixed(0) + ' 100';
          nodes['gl-mem'][i].innerHTML = names[i] ? names[i] : (mem ? 'mem: ' + mem.toFixed(0) + 'mb' : '');
          nodes['gl-fps'][i].innerHTML = fps.toFixed(0) + ' FPS';
          logger(names[i], cpu, gpu, mem, fps, totalTime, frameId);
        }
      })(this.paramLogger, this.dom, this.names);

      this.chartLogger = ((logger, dom) => {
        let nodes = { 'gl-chart': dom.getElementsByClassName('gl-chart') };
        return (i, chart, circularId) => {
          let points = '';
          let len = chart.length;
          for (let i = 0; i < len; i++) {
            let id = (circularId + i + 1) % len;
            if (chart[id] != undefined) {
              points = points + ' ' + (55 * i / (len - 1)).toFixed(1) + ','
                + (45 - chart[id] * 22 / 60 / this.detected).toFixed(1);
            }
          }
          nodes['gl-chart'][i].setAttribute('points', points);
          logger(this.names[i], chart, circularId);
        }
      })(this.chartLogger, this.dom);
    }
  }

  /**
   * Explicit UI add
   * @param { string | undefined } name 
   */
  addUI(name) {
    if (this.names.indexOf(name) == -1) {
      this.names.push(name);
      if (this.dom) {
        this.dom.insertAdjacentHTML('beforeend', this.svg);
        this.updateUI();
      }
      this.cpuAccums.push(0);
      this.gpuAccums.push(0);
      this.activeAccums.push(false);
    }
  }

  /**
   * Increase frameID
   * @param { number | undefined } now
   */
  nextFrame(now) {
    this.frameId++;
    const t = now ? now : this.now();

    // params
    if (this.frameId <= 1) {
      this.paramFrame = this.frameId;
      this.paramTime = t;
    } else {
      let duration = t - this.paramTime;
      if (duration >= 1e3) {
        const frameCount = this.frameId - this.paramFrame;
        const fps = frameCount / duration * 1e3;
        for (let i = 0; i < this.names.length; i++) {
          const cpu = this.cpuAccums[i] / duration * 100,
            gpu = this.gpuAccums[i] / duration * 100,
            mem = (performance && performance.memory) ? performance.memory.usedJSHeapSize / (1 << 20) : 0;
          this.paramLogger(i, cpu, gpu, mem, fps, duration, frameCount);
          this.cpuAccums[i] = 0;
          Promise.all(this.finished).then(() => {
            this.gpuAccums[i] = 0;
            this.finished = [];
          });
        }
        this.paramFrame = this.frameId;
        this.paramTime = t;
      }
    }

    // chart
    if (!this.detected) {
      this.chartFrame = this.frameId;
      this.chartTime = t;
      this.circularId = 0;
    } else {
      let timespan = t - this.chartTime;
      let hz = this.chartHz * timespan / 1e3;
      while (--hz > 0 && this.detected) {
        const frameCount = this.frameId - this.chartFrame;
        const fps = frameCount / timespan * 1e3;
        this.chart[this.circularId % this.chartLen] = fps;
        for (let i = 0; i < this.names.length; i++) {
          this.chartLogger(i, this.chart, this.circularId);
        }
        this.circularId++;
        this.chartFrame = this.frameId;
        this.chartTime = t;
      }
    }
  }

  /**
   * Begin named measurement
   * @param { string | undefined } name
   */
  begin(name) {
    this.updateAccums(name);
  }

  /**
   * End named measure
   * @param { string | undefined } name
   */
  end(name) {
    this.updateAccums(name);
  }

  updateAccums(name) {
    let nameId = this.names.indexOf(name);
    if (nameId == -1) {
      nameId = this.names.length;
      this.addUI(name);
    }

    const t = this.now();
    const dt = t - this.t0;
    for (let i = 0; i < nameId + 1; i++) {
      if (this.activeAccums[i]) {
        this.cpuAccums[i] += dt;
      }
    }    this.activeAccums[nameId] = !this.activeAccums[nameId];
    this.t0 = t;
  }

}

export default GLBench;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2wtYmVuY2gubW9kdWxlLmpzIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFVJU1ZHIGZyb20gJy4vdWkuc3ZnJztcbmltcG9ydCBVSUNTUyBmcm9tICcuL3VpLmNzcyc7XG5pbXBvcnQgeyBOT05BTUUgfSBmcm9tICdkbnMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHTEJlbmNoIHtcblxuICAvKiogR0xCZW5jaCBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0geyBXZWJHTFJlbmRlcmluZ0NvbnRleHQgfCBXZWJHTDJSZW5kZXJpbmdDb250ZXh0IH0gZ2wgY29udGV4dFxuICAgKiBAcGFyYW0geyBPYmplY3QgfCB1bmRlZmluZWQgfSBzZXR0aW5ncyBhZGRpdGlvbmFsIHNldHRpbmdzXG4gICAqL1xuICBjb25zdHJ1Y3RvcihnbCwgc2V0dGluZ3MgPSB7fSkge1xuICAgIHRoaXMuY3NzID0gVUlDU1M7XG4gICAgdGhpcy5zdmcgPSBVSVNWRztcbiAgICB0aGlzLnBhcmFtTG9nZ2VyID0gKCkgPT4ge307XG4gICAgdGhpcy5jaGFydExvZ2dlciA9ICgpID0+IHt9O1xuICAgIHRoaXMuY2hhcnRMZW4gPSAyMDtcbiAgICB0aGlzLmNoYXJ0SHogPSAyMDtcblxuICAgIHRoaXMubmFtZXMgPSBbXTtcbiAgICB0aGlzLmNwdUFjY3VtcyA9IFtdO1xuICAgIHRoaXMuZ3B1QWNjdW1zID0gW107ICBcbiAgICB0aGlzLmFjdGl2ZUFjY3VtcyA9IFtdO1xuICAgIHRoaXMuY2hhcnQgPSBuZXcgQXJyYXkodGhpcy5jaGFydExlbik7XG4gICAgdGhpcy5ub3cgPSAoKSA9PiAocGVyZm9ybWFuY2UgJiYgcGVyZm9ybWFuY2Uubm93KSA/IHBlcmZvcm1hbmNlLm5vdygpIDogRGF0ZS5ub3coKTtcbiAgICB0aGlzLnVwZGF0ZVVJID0gKCkgPT4ge1xuICAgICAgW10uZm9yRWFjaC5jYWxsKHRoaXMubm9kZXNbJ2dsLWdwdS1zdmcnXSwgbm9kZSA9PiB7XG4gICAgICAgIG5vZGUuc3R5bGUuZGlzcGxheSA9IHRoaXMudHJhY2tHUFUgPyAnaW5saW5lJyA6ICdub25lJztcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLCBzZXR0aW5ncyk7XG4gICAgdGhpcy5kZXRlY3RlZCA9IDA7XG4gICAgdGhpcy5maW5pc2hlZCA9IFtdO1xuICAgIHRoaXMuaXNGcmFtZWJ1ZmZlciA9IDA7XG4gICAgdGhpcy5mcmFtZUlkID0gMDtcblxuICAgIC8vIDEyMGh6IGRldmljZSBkZXRlY3Rpb25cbiAgICBsZXQgcmFmSWQsIG4gPSAwLCB0MDtcbiAgICBsZXQgbG9vcCA9ICh0KSA9PiB7XG4gICAgICBpZiAoKytuIDwgMTApIHtcbiAgICAgICAgcmFmSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmRldGVjdGVkID0gTWF0aC5jZWlsKDFlMyAqIG4gLyAodCAtIHQwKSAvIDcwKTtcbiAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUocmFmSWQpO1xuICAgICAgfVxuICAgICAgaWYgKCF0MCkgdDAgPSB0O1xuICAgIH1cbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XG5cbiAgICAvLyBhdHRhY2ggZ3B1IHByb2ZpbGVyc1xuICAgIGlmIChnbCkge1xuICAgICAgY29uc3QgZ2xGaW5pc2ggPSBhc3luYyAodCwgYWN0aXZlQWNjdW1zKSA9PlxuICAgICAgICBQcm9taXNlLnJlc29sdmUoc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgaWYgKHRoaXMuaXNGcmFtZWJ1ZmZlcikge1xuICAgICAgICAgICAgZ2wuZmluaXNoKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdsLnJlYWRQaXhlbHMoMCwgMCwgMSwgMSwgZ2wuUkdCQSwgZ2wuVU5TSUdORURfQllURSwgbmV3IFVpbnQ4QXJyYXkoNCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBkdCA9IHRoaXMubm93KCkgLSB0O1xuICAgICAgICAgIGFjdGl2ZUFjY3Vtcy5mb3JFYWNoKChhY3RpdmUsIGkpID0+IHtcbiAgICAgICAgICAgIGlmIChhY3RpdmUpIHRoaXMuZ3B1QWNjdW1zW2ldICs9IGR0O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LCAwKSk7XG5cbiAgICAgIGNvbnN0IGFkZFByb2ZpbGVyID0gKGZuLCBzZWxmLCB0YXJnZXQpID0+IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCB0ID0gc2VsZi5ub3coKTtcbiAgICAgICAgZm4uYXBwbHkodGFyZ2V0LCBhcmd1bWVudHMpO1xuICAgICAgICBpZiAoc2VsZi50cmFja0dQVSkge1xuICAgICAgICAgIHNlbGYuZmluaXNoZWQucHVzaChnbEZpbmlzaCh0LCBzZWxmLmFjdGl2ZUFjY3Vtcy5zbGljZSgwKSkpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBbJ2RyYXdBcnJheXMnLCAnZHJhd0VsZW1lbnRzJywgJ2RyYXdBcnJheXNJbnN0YW5jZWQnLFxuICAgICAgICAnZHJhd0J1ZmZlcnMnLCAnZHJhd0VsZW1lbnRzSW5zdGFuY2VkJywgJ2RyYXdSYW5nZUVsZW1lbnRzJ11cbiAgICAgICAgLmZvckVhY2goZm4gPT4geyBpZiAoZ2xbZm5dKSBnbFtmbl0gPSBhZGRQcm9maWxlcihnbFtmbl0sIHRoaXMsIGdsKSB9KTtcblxuICAgICAgZ2wuZ2V0RXh0ZW5zaW9uID0gKChmbiwgc2VsZikgPT4gZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBleHQgPSBmbi5hcHBseShnbCwgYXJndW1lbnRzKTtcbiAgICAgICAgWydkcmF3RWxlbWVudHNJbnN0YW5jZWRBTkdMRScsICdkcmF3QnVmZmVyc1dFQkdMJ11cbiAgICAgICAgICAuZm9yRWFjaChmbiA9PiB7IGlmIChleHRbZm5dKSBleHRbZm5dID0gYWRkUHJvZmlsZXIoZXh0W2ZuXSwgc2VsZiwgZXh0KSB9KTtcbiAgICAgICAgcmV0dXJuIGV4dDtcbiAgICAgIH0pKGdsLmdldEV4dGVuc2lvbiwgdGhpcyk7XG5cbiAgICAgIGdsLmJpbmRGcmFtZWJ1ZmZlciA9ICgoZm4sIHRhcmdldCwgc2VsZikgPT4gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZuLmFwcGx5KHRhcmdldCwgYXJndW1lbnRzKTtcbiAgICAgICAgc2VsZi5pc0ZyYW1lYnVmZmVyID0gIWFyZ3VtZW50c1sxXTtcbiAgICAgIH0pKGdsLmJpbmRGcmFtZWJ1ZmZlciwgZ2wsIHRoaXMpO1xuICAgIH1cblxuICAgIC8vIGluaXQgdWkgYW5kIHVpIGxvZ2dlcnNcbiAgICBpZiAoIXRoaXMud2l0aG91dFVJKSB7XG4gICAgICBpZiAoIXRoaXMuZG9tKSB0aGlzLmRvbSA9IGRvY3VtZW50LmJvZHk7XG4gICAgICBsZXQgZWxtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBlbG0uaWQgPSAnZ2wtYmVuY2gnO1xuICAgICAgdGhpcy5kb20uYXBwZW5kQ2hpbGQoZWxtKTtcbiAgICAgIHRoaXMuZG9tLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsICc8c3R5bGUgaWQ9XCJnbC1iZW5jaC1zdHlsZVwiPicgKyB0aGlzLmNzcyArICc8L3N0eWxlPicpO1xuICAgICAgdGhpcy5kb20gPSBlbG07XG4gICAgICB0aGlzLmRvbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgdGhpcy50cmFja0dQVSA9ICF0aGlzLnRyYWNrR1BVO1xuICAgICAgICB0aGlzLnVwZGF0ZVVJKCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5wYXJhbUxvZ2dlciA9ICgobG9nZ2VyLCBkb20sIG5hbWVzKSA9PiB7XG4gICAgICAgIGNvbnN0IGNsYXNzZXMgPSBbJ2dsLWNwdScsICdnbC1ncHUnLCAnZ2wtbWVtJywgJ2dsLWZwcycsICdnbC1ncHUtc3ZnJywgJ2dsLWNoYXJ0J107XG4gICAgICAgIGNvbnN0IG5vZGVzID0gT2JqZWN0LmFzc2lnbih7fSwgY2xhc3Nlcyk7XG4gICAgICAgIGNsYXNzZXMuZm9yRWFjaChjID0+IG5vZGVzW2NdID0gZG9tLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYykpO1xuICAgICAgICB0aGlzLm5vZGVzID0gbm9kZXM7XG4gICAgICAgIHJldHVybiAoaSwgY3B1LCBncHUsIG1lbSwgZnBzLCB0b3RhbFRpbWUsIGZyYW1lSWQpID0+IHtcbiAgICAgICAgICBub2Rlc1snZ2wtY3B1J11baV0uc3R5bGUuc3Ryb2tlRGFzaGFycmF5ID0gKGNwdSAqIDAuMjcpLnRvRml4ZWQoMCkgKyAnIDEwMCc7XG4gICAgICAgICAgbm9kZXNbJ2dsLWdwdSddW2ldLnN0eWxlLnN0cm9rZURhc2hhcnJheSA9IChncHUgKiAwLjI3KS50b0ZpeGVkKDApICsgJyAxMDAnO1xuICAgICAgICAgIG5vZGVzWydnbC1tZW0nXVtpXS5pbm5lckhUTUwgPSBuYW1lc1tpXSA/IG5hbWVzW2ldIDogKG1lbSA/ICdtZW06ICcgKyBtZW0udG9GaXhlZCgwKSArICdtYicgOiAnJyk7XG4gICAgICAgICAgbm9kZXNbJ2dsLWZwcyddW2ldLmlubmVySFRNTCA9IGZwcy50b0ZpeGVkKDApICsgJyBGUFMnO1xuICAgICAgICAgIGxvZ2dlcihuYW1lc1tpXSwgY3B1LCBncHUsIG1lbSwgZnBzLCB0b3RhbFRpbWUsIGZyYW1lSWQpO1xuICAgICAgICB9XG4gICAgICB9KSh0aGlzLnBhcmFtTG9nZ2VyLCB0aGlzLmRvbSwgdGhpcy5uYW1lcyk7XG5cbiAgICAgIHRoaXMuY2hhcnRMb2dnZXIgPSAoKGxvZ2dlciwgZG9tKSA9PiB7XG4gICAgICAgIGxldCBub2RlcyA9IHsgJ2dsLWNoYXJ0JzogZG9tLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2dsLWNoYXJ0JykgfTtcbiAgICAgICAgcmV0dXJuIChpLCBjaGFydCwgY2lyY3VsYXJJZCkgPT4ge1xuICAgICAgICAgIGxldCBwb2ludHMgPSAnJztcbiAgICAgICAgICBsZXQgbGVuID0gY2hhcnQubGVuZ3RoO1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBpZCA9IChjaXJjdWxhcklkICsgaSArIDEpICUgbGVuO1xuICAgICAgICAgICAgaWYgKGNoYXJ0W2lkXSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgcG9pbnRzID0gcG9pbnRzICsgJyAnICsgKDU1ICogaSAvIChsZW4gLSAxKSkudG9GaXhlZCgxKSArICcsJ1xuICAgICAgICAgICAgICAgICsgKDQ1IC0gY2hhcnRbaWRdICogMjIgLyA2MCAvIHRoaXMuZGV0ZWN0ZWQpLnRvRml4ZWQoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIG5vZGVzWydnbC1jaGFydCddW2ldLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgcG9pbnRzKTtcbiAgICAgICAgICBsb2dnZXIodGhpcy5uYW1lc1tpXSwgY2hhcnQsIGNpcmN1bGFySWQpO1xuICAgICAgICB9XG4gICAgICB9KSh0aGlzLmNoYXJ0TG9nZ2VyLCB0aGlzLmRvbSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4cGxpY2l0IFVJIGFkZFxuICAgKiBAcGFyYW0geyBzdHJpbmcgfCB1bmRlZmluZWQgfSBuYW1lIFxuICAgKi9cbiAgYWRkVUkobmFtZSkge1xuICAgIGlmICh0aGlzLm5hbWVzLmluZGV4T2YobmFtZSkgPT0gLTEpIHtcbiAgICAgIHRoaXMubmFtZXMucHVzaChuYW1lKTtcbiAgICAgIGlmICh0aGlzLmRvbSkge1xuICAgICAgICB0aGlzLmRvbS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIHRoaXMuc3ZnKTtcbiAgICAgICAgdGhpcy51cGRhdGVVSSgpO1xuICAgICAgfVxuICAgICAgdGhpcy5jcHVBY2N1bXMucHVzaCgwKTtcbiAgICAgIHRoaXMuZ3B1QWNjdW1zLnB1c2goMCk7XG4gICAgICB0aGlzLmFjdGl2ZUFjY3Vtcy5wdXNoKGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSW5jcmVhc2UgZnJhbWVJRFxuICAgKiBAcGFyYW0geyBudW1iZXIgfCB1bmRlZmluZWQgfSBub3dcbiAgICovXG4gIG5leHRGcmFtZShub3cpIHtcbiAgICB0aGlzLmZyYW1lSWQrKztcbiAgICBjb25zdCB0ID0gbm93ID8gbm93IDogdGhpcy5ub3coKTtcblxuICAgIC8vIHBhcmFtc1xuICAgIGlmICh0aGlzLmZyYW1lSWQgPD0gMSkge1xuICAgICAgdGhpcy5wYXJhbUZyYW1lID0gdGhpcy5mcmFtZUlkO1xuICAgICAgdGhpcy5wYXJhbVRpbWUgPSB0O1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgZHVyYXRpb24gPSB0IC0gdGhpcy5wYXJhbVRpbWU7XG4gICAgICBpZiAoZHVyYXRpb24gPj0gMWUzKSB7XG4gICAgICAgIGNvbnN0IGZyYW1lQ291bnQgPSB0aGlzLmZyYW1lSWQgLSB0aGlzLnBhcmFtRnJhbWU7XG4gICAgICAgIGNvbnN0IGZwcyA9IGZyYW1lQ291bnQgLyBkdXJhdGlvbiAqIDFlMztcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgY3B1ID0gdGhpcy5jcHVBY2N1bXNbaV0gLyBkdXJhdGlvbiAqIDEwMCxcbiAgICAgICAgICAgIGdwdSA9IHRoaXMuZ3B1QWNjdW1zW2ldIC8gZHVyYXRpb24gKiAxMDAsXG4gICAgICAgICAgICBtZW0gPSAocGVyZm9ybWFuY2UgJiYgcGVyZm9ybWFuY2UubWVtb3J5KSA/IHBlcmZvcm1hbmNlLm1lbW9yeS51c2VkSlNIZWFwU2l6ZSAvICgxIDw8IDIwKSA6IDA7XG4gICAgICAgICAgdGhpcy5wYXJhbUxvZ2dlcihpLCBjcHUsIGdwdSwgbWVtLCBmcHMsIGR1cmF0aW9uLCBmcmFtZUNvdW50KTtcbiAgICAgICAgICB0aGlzLmNwdUFjY3Vtc1tpXSA9IDA7XG4gICAgICAgICAgUHJvbWlzZS5hbGwodGhpcy5maW5pc2hlZCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmdwdUFjY3Vtc1tpXSA9IDA7XG4gICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gW107XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJhbUZyYW1lID0gdGhpcy5mcmFtZUlkO1xuICAgICAgICB0aGlzLnBhcmFtVGltZSA9IHQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gY2hhcnRcbiAgICBpZiAoIXRoaXMuZGV0ZWN0ZWQpIHtcbiAgICAgIHRoaXMuY2hhcnRGcmFtZSA9IHRoaXMuZnJhbWVJZDtcbiAgICAgIHRoaXMuY2hhcnRUaW1lID0gdDtcbiAgICAgIHRoaXMuY2lyY3VsYXJJZCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCB0aW1lc3BhbiA9IHQgLSB0aGlzLmNoYXJ0VGltZTtcbiAgICAgIGxldCBoeiA9IHRoaXMuY2hhcnRIeiAqIHRpbWVzcGFuIC8gMWUzO1xuICAgICAgd2hpbGUgKC0taHogPiAwICYmIHRoaXMuZGV0ZWN0ZWQpIHtcbiAgICAgICAgY29uc3QgZnJhbWVDb3VudCA9IHRoaXMuZnJhbWVJZCAtIHRoaXMuY2hhcnRGcmFtZTtcbiAgICAgICAgY29uc3QgZnBzID0gZnJhbWVDb3VudCAvIHRpbWVzcGFuICogMWUzO1xuICAgICAgICB0aGlzLmNoYXJ0W3RoaXMuY2lyY3VsYXJJZCAlIHRoaXMuY2hhcnRMZW5dID0gZnBzO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubmFtZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB0aGlzLmNoYXJ0TG9nZ2VyKGksIHRoaXMuY2hhcnQsIHRoaXMuY2lyY3VsYXJJZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jaXJjdWxhcklkKys7XG4gICAgICAgIHRoaXMuY2hhcnRGcmFtZSA9IHRoaXMuZnJhbWVJZDtcbiAgICAgICAgdGhpcy5jaGFydFRpbWUgPSB0O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBCZWdpbiBuYW1lZCBtZWFzdXJlbWVudFxuICAgKiBAcGFyYW0geyBzdHJpbmcgfCB1bmRlZmluZWQgfSBuYW1lXG4gICAqL1xuICBiZWdpbihuYW1lKSB7XG4gICAgdGhpcy51cGRhdGVBY2N1bXMobmFtZSk7XG4gIH1cblxuICAvKipcbiAgICogRW5kIG5hbWVkIG1lYXN1cmVcbiAgICogQHBhcmFtIHsgc3RyaW5nIHwgdW5kZWZpbmVkIH0gbmFtZVxuICAgKi9cbiAgZW5kKG5hbWUpIHtcbiAgICB0aGlzLnVwZGF0ZUFjY3VtcyhuYW1lKTtcbiAgfVxuXG4gIHVwZGF0ZUFjY3VtcyhuYW1lKSB7XG4gICAgbGV0IG5hbWVJZCA9IHRoaXMubmFtZXMuaW5kZXhPZihuYW1lKTtcbiAgICBpZiAobmFtZUlkID09IC0xKSB7XG4gICAgICBuYW1lSWQgPSB0aGlzLm5hbWVzLmxlbmd0aDtcbiAgICAgIHRoaXMuYWRkVUkobmFtZSk7XG4gICAgfVxuXG4gICAgY29uc3QgdCA9IHRoaXMubm93KCk7XG4gICAgY29uc3QgZHQgPSB0IC0gdGhpcy50MDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVJZCArIDE7IGkrKykge1xuICAgICAgaWYgKHRoaXMuYWN0aXZlQWNjdW1zW2ldKSB7XG4gICAgICAgIHRoaXMuY3B1QWNjdW1zW2ldICs9IGR0O1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5hY3RpdmVBY2N1bXNbbmFtZUlkXSA9ICF0aGlzLmFjdGl2ZUFjY3Vtc1tuYW1lSWRdO1xuICAgIHRoaXMudDAgPSB0O1xuICB9XG5cbn0iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBSWUsTUFBTSxPQUFPLENBQUM7Ozs7OztFQU0zQixXQUFXLENBQUMsRUFBRSxFQUFFLFFBQVEsR0FBRyxFQUFFLEVBQUU7SUFDN0IsSUFBSSxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUM7SUFDakIsSUFBSSxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUM7SUFDakIsSUFBSSxDQUFDLFdBQVcsR0FBRyxNQUFNLEVBQUUs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
