var UISVG = "<div class=\"gl-box\">\n  <svg viewBox=\"0 0 55 60\">\n    <text x=\"27\" y=\"56\" font-size=\"0.75em\" class=\"gl-fps\">00 FPS</text>\n    <text x=\"28\" y=\"8\" font-size=\"0.55rem\" class=\"gl-mem\"></text>\n    <rect x=\"0\" y=\"14\" rx=\"4\" ry=\"4\" width=\"55\" height=\"32\" opacity=\"0.4\"/>\n    <polyline points=\"0 0 0 0\" class=\"gl-chart\"/>\n  </svg>\n  <svg viewBox=\"0 0 14 60\">\n    <line x1=\"7\" y1=\"38\" x2=\"7\" y2=\"11\" opacity=\"0.4\"/>\n    <line x1=\"7\" y1=\"38\" x2=\"7\" y2=\"11\" opacity=\"0.7\" stroke-dasharray=\"0 27\" class=\"gl-cpu\"/>\n    <path transform=\"translate(1,43) scale(.29)\" d=\"m15 0c-1.6 3e-16 -2.8 1.3-2.8 2.8v4c-2.7 0.68-4.9 2.8-5.5 5.6h-4c-1.5 0-2.8 1.2-2.8 2.8s1.2 2.8 2.8 2.8h3.8v5.7h-3.7c-1.6 0-2.8 1.3-2.8 2.8 3e-16 1.6 1.3 2.8 2.8 2.8h3.9c0.67 2.7 2.8 4.8 5.5 5.5v3.9c0 1.6 1.3 2.8 2.8 2.8 1.6 0 2.8-1.3 2.8-2.8v-3.7h5.7v3.7c0 1.6 1.3 2.8 2.8 2.8 1.6 0 2.8-1.3 2.8-2.8v-3.9c2.7-0.67 4.8-2.8 5.5-5.5h3.9c1.6 0 2.8-1.3 2.8-2.8 0-1.6-1.3-2.8-2.8-2.8h-3.7v-5.7h3.8c1.5 0 2.8-1.2 2.8-2.8s-1.2-2.8-2.8-2.8h-4c-0.65-2.7-2.8-4.9-5.5-5.6v-3.9c0-1.6-1.3-2.8-2.8-2.8-1.6 3e-16 -2.8 1.3-2.8 2.8v3.7h-5.7v-3.7c0-1.6-1.3-2.8-2.8-2.8zm2 12h7.2c2.6 0 4.7 2.1 4.7 4.7v7.2c0 2.6-2.1 4.7-4.7 4.7h-7.2c-2.6 0-4.7-2.1-4.7-4.7v-7.2c0-2.6 2.1-4.7 4.7-4.7z\"/>\n  </svg>\n  <svg viewBox=\"0 0 14 60\" class=\"gl-gpu-svg\">\n    <line x1=\"7\" y1=\"38\" x2=\"7\" y2=\"11\" opacity=\"0.4\"/>\n    <line x1=\"7\" y1=\"38\" x2=\"7\" y2=\"11\" opacity=\"0.7\" stroke-dasharray=\"0 27\" class=\"gl-gpu\"/>\n    <path transform=\"translate(0.93,43) scale(1.15)\" d=\"m0.88 0.33c-0.85-0.0024-0.86 1.3-0.0036 1.3 0.48 0.015 0.57 0.48 0.59 0.89v7.4c0 0.85 1.3 0.85 1.3 0v-1.1c1.8-0.018 3.5-0.0083 5.3-0.0083 1.1-1.6e-5 2-0.85 2-1.9v-2.7c0-1-0.88-1.9-2-1.9-1.8 8.2e-6 -3.5 5.7e-5 -5.3 5e-5 0 0-0.013-0.42-0.17-0.84-0.2-0.53-0.78-1.1-1.7-1.1zm2.5 3.2c0.37 0 0.67 0.32 0.67 0.71v2.6c0 0.39-0.3 0.71-0.67 0.71s-0.67-0.32-0.67-0.71v-2.6c0-0.39 0.3-0.71 0.67-0.71zm3.6 0c1.1 0 2 0.9 2 2s-0.9 2-2 2-2-0.9-2-2 0.9-2 2-2z\"/>\n  </svg>\n</div>";

var UICSS = "#gl-bench {\n  position:absolute;\n  left:0;\n  top:0;\n  z-index:1000;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n}\n\n#gl-bench svg {\n  height: 60px;\n  margin: 0 -1px;\n}\n\n#gl-bench div {\n  position: relative;\n  display: block;\n  margin: 5px;\n  padding: 0 7px 0 10px;\n  background: hsla(120, 50%, 60%, 1);\n  border-radius: 15px;\n  cursor: pointer;\n  opacity: 0.9;\n}\n\n#gl-bench text {\n  font-family: Helvetica,Arial,sans-serif;\n  font-weight: 700;\n  dominant-baseline: middle;\n  text-anchor: middle;\n}\n\n#gl-bench line {\n  stroke-width: 5;\n  stroke: black;\n  stroke-linecap: round;\n}\n\n#gl-bench polyline {\n  fill: none;\n  stroke: black;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n  stroke-width: 3.5;\n  opacity: 0.8;\n}";

class GLBench {

  /** GLBench constructor
   * @param { WebGLRenderingContext | WebGL2RenderingContext } gl context
   * @param { Object | undefined } settings additional settings
   */
  constructor(gl, settings = {}) {
    this.css = UICSS;
    this.svg = UISVG;
    this.paramLogger = () => {};
    this.chartLogger = () => {};
    this.chartLen = 20;

    this.names = [];
    this.cpuAccums = [];
    this.gpuAccums = [];  
    this.activeAccums = [];
    this.chart = new Array(this.chartLen);
    this.now = () => (performance && performance.now) ? performance.now() : Date.now();

    Object.assign(this, settings);
    this.frameId = -1;

    // attach gpu profilers
    if (gl) {
      const addProfilers = (fn, self, target) => function() {
        const t = self.now();
        fn.apply(target, arguments);
        if (!self.withoutGPU) {
          gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array(4));
          const dt = self.now() - t;
          self.activeAccums.forEach((active, i) => {
            if (active) {
              self.gpuAccums[i] += dt;
              self.cpuAccums[i] -= dt;
            }
          });
        }
      };
      ['drawArrays', 'drawElements', 'drawArraysInstanced',
        'drawBuffers', 'drawElementsInstanced', 'drawRangeElements']
        .forEach(fn => { if (gl[fn]) gl[fn] = addProfilers(gl[fn], this, gl); });

      const addExtProfilers = (fn, self) => function() {
        let ext = fn.apply(gl, arguments);
        ['drawElementsInstancedANGLE']
          .forEach(fn => { if (ext[fn]) ext[fn] = addProfilers(ext[fn], self, ext); });
        return ext;
      };
      gl.getExtension = addExtProfilers(gl.getExtension, this);
    }

    // init ui and ui loggers
    if (!this.withoutUI) {
      this.dom = document.getElementById('gl-bench');
      if (!this.dom) {
        document.body.insertAdjacentHTML('afterbegin', '<div id="gl-bench"></div>');
        document.body.insertAdjacentHTML('afterbegin', '<style id="gl-bench-style">' + this.css + '</style>');
        this.dom = document.getElementById('gl-bench');
      }
      this.dom.addEventListener('click', () => {
        this.withoutGPU = !this.withoutGPU;
        setTimeout(() => {
          [].forEach.call(this.nodes['gl-gpu-svg'], node => {
            node.style.display = this.withoutGPU ? 'none' : 'inline';
          });
        }, 500);
      });

      this.paramLogger = ((logger, dom, names) => {
        this.names = names;
        const classes = ['gl-cpu', 'gl-gpu', 'gl-mem', 'gl-fps', 'gl-gpu-svg', 'gl-chart'];
        this.nodes = Object.assign({}, classes);
        classes.forEach(c => this.nodes[c] = dom.getElementsByClassName(c));
        return (i, cpu, gpu, mem, fps, totalTime, frameId) => {
          this.nodes['gl-cpu'][i].style.strokeDasharray = (cpu * 0.27).toFixed(0) + ' 100';
          this.nodes['gl-gpu'][i].style.strokeDasharray = (gpu * 0.27).toFixed(0) + ' 100';
          this.nodes['gl-mem'][i].innerHTML = this.names[i] ? this.names[i] : 'mem: ' + mem.toFixed(0) + 'mb';
          this.nodes['gl-fps'][i].innerHTML = fps.toFixed(0) + ' FPS';
          logger(this.names[i], cpu, gpu, mem, fps, totalTime, frameId);
        }
      })(this.paramLogger, this.dom, this.names);

      this.chartLogger = ((logger, dom) => {
        this.wtf = Object.assign({}, ['gl-chart']);
        this.wtf['gl-chart'] = dom.getElementsByClassName('gl-chart');
        return (i, chart, circularId) => {
          let points = '';
          for (let i = 0; i < chart.length; i++) {
            let id = (circularId + i + 1) % chart.length;
            if (chart[id] != undefined) {
              points = points + ' ' + (55 * i / (chart.length - 1)).toFixed(1) + ',' + (46 - chart[id] * 24 / 60).toFixed(1);
            }
          }
          this.wtf['gl-chart'][i].setAttribute('points', points);
          logger(this.names[i], chart, circularId);
        }
      })(this.chartLogger, this.dom);
    }
  }

  /**
   * Explicit UI add
   * @param { string | undefined } name 
   */
  addUI(name) {
    if (this.names.indexOf(name) == -1) {
      this.names.push(name);
      if (this.dom) this.dom.insertAdjacentHTML('beforeend', this.svg);
      this.cpuAccums.push(0);
      this.gpuAccums.push(0);
      this.activeAccums.push(false);
    }
  }

  /**
   * Increase frameID
   * @param { number | undefined } now
   */
  nextFrame(now) {
    this.frameId++;
    const t = now ? now : this.now();

    // update params
    if (this.frameId < 2) {
      this.frameStart = this.frameId;
      this.timeStart = t;
    } else {
      const duration = t - this.timeStart;
      if (duration >= 1e3) {
        const frameCount = this.frameId - this.frameStart;
        const fps = frameCount / duration * 1e3;
        for (let i = 0; i < this.names.length; i++) {
          const cpu = this.cpuAccums[i] / duration * 100,
            gpu = this.gpuAccums[i] / duration * 100,
            mem = (performance && performance.memory) ? performance.memory.usedJSHeapSize / (1 << 20) : 0;
          this.paramLogger(i, cpu, gpu, mem, fps, duration, frameCount);
          this.cpuAccums[i] = 0;
          this.gpuAccums[i] = 0;
        }
        this.frameStart = this.frameId;
        this.timeStart = t;
      }
    }

    // update chart
    if (this.frameId < 2) {
      this.circularId = 0;
      this.prevFrame = this.frameId;
      this.zerotime = t;
    } else {
      const duration = t - this.zerotime;
      let hz = 20 * duration / 1e3;
      while (--hz > 0) {
        const frameCount = this.frameId - this.prevFrame;
        const fps = frameCount / duration * 1e3;
        this.chart[this.circularId % this.chartLen] = fps;
        for (let i = 0; i < this.names.length; i++) {
          this.chartLogger(i, this.chart, this.circularId);
        }
        this.circularId++;
        this.prevFrame = this.frameId;
        this.zerotime = t;
      }
    }
  }

  /**
   * Begin named measurement
   * @param { string | undefined } name
   */
  begin(name) {
    this.updateAccums(name);
  }

  /**
   * End named measure
   * @param { string | undefined } name
   */
  end(name) {
    this.updateAccums(name);
  }

  updateAccums(name) {
    let nameId = this.names.indexOf(name);
    if (nameId == -1) {
      nameId = this.names.length;
      this.addUI(name);
    }

    const t = this.now();
    const dt = t - this.t0;
    for (let i = 0; i < nameId + 1; i++) {
      if (this.activeAccums[i]) {
        this.cpuAccums[i] += dt;
      }
    }    this.activeAccums[nameId] = !this.activeAccums[nameId];
    this.t0 = t;
  }
}

export default GLBench;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2wtYmVuY2gubW9kdWxlLmpzIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFVJU1ZHIGZyb20gJy4vdWkuc3ZnJztcbmltcG9ydCBVSUNTUyBmcm9tICcuL3VpLmNzcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdMQmVuY2gge1xuXG4gIC8qKiBHTEJlbmNoIGNvbnN0cnVjdG9yXG4gICAqIEBwYXJhbSB7IFdlYkdMUmVuZGVyaW5nQ29udGV4dCB8IFdlYkdMMlJlbmRlcmluZ0NvbnRleHQgfSBnbCBjb250ZXh0XG4gICAqIEBwYXJhbSB7IE9iamVjdCB8IHVuZGVmaW5lZCB9IHNldHRpbmdzIGFkZGl0aW9uYWwgc2V0dGluZ3NcbiAgICovXG4gIGNvbnN0cnVjdG9yKGdsLCBzZXR0aW5ncyA9IHt9KSB7XG4gICAgdGhpcy5jc3MgPSBVSUNTUztcbiAgICB0aGlzLnN2ZyA9IFVJU1ZHO1xuICAgIHRoaXMucGFyYW1Mb2dnZXIgPSAoKSA9PiB7fTtcbiAgICB0aGlzLmNoYXJ0TG9nZ2VyID0gKCkgPT4ge307XG4gICAgdGhpcy5jaGFydExlbiA9IDIwO1xuXG4gICAgdGhpcy5uYW1lcyA9IFtdO1xuICAgIHRoaXMuY3B1QWNjdW1zID0gW107XG4gICAgdGhpcy5ncHVBY2N1bXMgPSBbXTsgIFxuICAgIHRoaXMuYWN0aXZlQWNjdW1zID0gW107XG4gICAgdGhpcy5jaGFydCA9IG5ldyBBcnJheSh0aGlzLmNoYXJ0TGVuKTtcbiAgICB0aGlzLm5vdyA9ICgpID0+IChwZXJmb3JtYW5jZSAmJiBwZXJmb3JtYW5jZS5ub3cpID8gcGVyZm9ybWFuY2Uubm93KCkgOiBEYXRlLm5vdygpO1xuXG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLCBzZXR0aW5ncyk7XG4gICAgdGhpcy5mcmFtZUlkID0gLTE7XG5cbiAgICAvLyBhdHRhY2ggZ3B1IHByb2ZpbGVyc1xuICAgIGlmIChnbCkge1xuICAgICAgY29uc3QgYWRkUHJvZmlsZXJzID0gKGZuLCBzZWxmLCB0YXJnZXQpID0+IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCB0ID0gc2VsZi5ub3coKTtcbiAgICAgICAgZm4uYXBwbHkodGFyZ2V0LCBhcmd1bWVudHMpO1xuICAgICAgICBpZiAoIXNlbGYud2l0aG91dEdQVSkge1xuICAgICAgICAgIGdsLnJlYWRQaXhlbHMoMCwgMCwgMSwgMSwgZ2wuUkdCQSwgZ2wuVU5TSUdORURfQllURSwgbmV3IFVpbnQ4QXJyYXkoNCkpO1xuICAgICAgICAgIGNvbnN0IGR0ID0gc2VsZi5ub3coKSAtIHQ7XG4gICAgICAgICAgc2VsZi5hY3RpdmVBY2N1bXMuZm9yRWFjaCgoYWN0aXZlLCBpKSA9PiB7XG4gICAgICAgICAgICBpZiAoYWN0aXZlKSB7XG4gICAgICAgICAgICAgIHNlbGYuZ3B1QWNjdW1zW2ldICs9IGR0O1xuICAgICAgICAgICAgICBzZWxmLmNwdUFjY3Vtc1tpXSAtPSBkdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFsnZHJhd0FycmF5cycsICdkcmF3RWxlbWVudHMnLCAnZHJhd0FycmF5c0luc3RhbmNlZCcsXG4gICAgICAgICdkcmF3QnVmZmVycycsICdkcmF3RWxlbWVudHNJbnN0YW5jZWQnLCAnZHJhd1JhbmdlRWxlbWVudHMnXVxuICAgICAgICAuZm9yRWFjaChmbiA9PiB7IGlmIChnbFtmbl0pIGdsW2ZuXSA9IGFkZFByb2ZpbGVycyhnbFtmbl0sIHRoaXMsIGdsKSB9KTtcblxuICAgICAgY29uc3QgYWRkRXh0UHJvZmlsZXJzID0gKGZuLCBzZWxmKSA9PiBmdW5jdGlvbigpIHtcbiAgICAgICAgbGV0IGV4dCA9IGZuLmFwcGx5KGdsLCBhcmd1bWVudHMpO1xuICAgICAgICBbJ2RyYXdFbGVtZW50c0luc3RhbmNlZEFOR0xFJ11cbiAgICAgICAgICAuZm9yRWFjaChmbiA9PiB7IGlmIChleHRbZm5dKSBleHRbZm5dID0gYWRkUHJvZmlsZXJzKGV4dFtmbl0sIHNlbGYsIGV4dCkgfSk7XG4gICAgICAgIHJldHVybiBleHQ7XG4gICAgICB9O1xuICAgICAgZ2wuZ2V0RXh0ZW5zaW9uID0gYWRkRXh0UHJvZmlsZXJzKGdsLmdldEV4dGVuc2lvbiwgdGhpcyk7XG4gICAgfVxuXG4gICAgLy8gaW5pdCB1aSBhbmQgdWkgbG9nZ2Vyc1xuICAgIGlmICghdGhpcy53aXRob3V0VUkpIHtcbiAgICAgIHRoaXMuZG9tID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dsLWJlbmNoJyk7XG4gICAgICBpZiAoIXRoaXMuZG9tKSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmJlZ2luJywgJzxkaXYgaWQ9XCJnbC1iZW5jaFwiPjwvZGl2PicpO1xuICAgICAgICBkb2N1bWVudC5ib2R5Lmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsICc8c3R5bGUgaWQ9XCJnbC1iZW5jaC1zdHlsZVwiPicgKyB0aGlzLmNzcyArICc8L3N0eWxlPicpO1xuICAgICAgICB0aGlzLmRvbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnbC1iZW5jaCcpO1xuICAgICAgfVxuICAgICAgdGhpcy5kb20uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHRoaXMud2l0aG91dEdQVSA9ICF0aGlzLndpdGhvdXRHUFU7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIFtdLmZvckVhY2guY2FsbCh0aGlzLm5vZGVzWydnbC1ncHUtc3ZnJ10sIG5vZGUgPT4ge1xuICAgICAgICAgICAgbm9kZS5zdHlsZS5kaXNwbGF5ID0gdGhpcy53aXRob3V0R1BVID8gJ25vbmUnIDogJ2lubGluZSc7XG4gICAgICAgICAgfSlcbiAgICAgICAgfSwgNTAwKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLnBhcmFtTG9nZ2VyID0gKChsb2dnZXIsIGRvbSwgbmFtZXMpID0+IHtcbiAgICAgICAgdGhpcy5uYW1lcyA9IG5hbWVzO1xuICAgICAgICBjb25zdCBjbGFzc2VzID0gWydnbC1jcHUnLCAnZ2wtZ3B1JywgJ2dsLW1lbScsICdnbC1mcHMnLCAnZ2wtZ3B1LXN2ZycsICdnbC1jaGFydCddO1xuICAgICAgICB0aGlzLm5vZGVzID0gT2JqZWN0LmFzc2lnbih7fSwgY2xhc3Nlcyk7XG4gICAgICAgIGNsYXNzZXMuZm9yRWFjaChjID0+IHRoaXMubm9kZXNbY10gPSBkb20uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjKSk7XG4gICAgICAgIHJldHVybiAoaSwgY3B1LCBncHUsIG1lbSwgZnBzLCB0b3RhbFRpbWUsIGZyYW1lSWQpID0+IHtcbiAgICAgICAgICB0aGlzLm5vZGVzWydnbC1jcHUnXVtpXS5zdHlsZS5zdHJva2VEYXNoYXJyYXkgPSAoY3B1ICogMC4yNykudG9GaXhlZCgwKSArICcgMTAwJztcbiAgICAgICAgICB0aGlzLm5vZGVzWydnbC1ncHUnXVtpXS5zdHlsZS5zdHJva2VEYXNoYXJyYXkgPSAoZ3B1ICogMC4yNykudG9GaXhlZCgwKSArICcgMTAwJztcbiAgICAgICAgICB0aGlzLm5vZGVzWydnbC1tZW0nXVtpXS5pbm5lckhUTUwgPSB0aGlzLm5hbWVzW2ldID8gdGhpcy5uYW1lc1tpXSA6ICdtZW06ICcgKyBtZW0udG9GaXhlZCgwKSArICdtYic7XG4gICAgICAgICAgdGhpcy5ub2Rlc1snZ2wtZnBzJ11baV0uaW5uZXJIVE1MID0gZnBzLnRvRml4ZWQoMCkgKyAnIEZQUyc7XG4gICAgICAgICAgbG9nZ2VyKHRoaXMubmFtZXNbaV0sIGNwdSwgZ3B1LCBtZW0sIGZwcywgdG90YWxUaW1lLCBmcmFtZUlkKTtcbiAgICAgICAgfVxuICAgICAgfSkodGhpcy5wYXJhbUxvZ2dlciwgdGhpcy5kb20sIHRoaXMubmFtZXMpO1xuXG4gICAgICB0aGlzLmNoYXJ0TG9nZ2VyID0gKChsb2dnZXIsIGRvbSkgPT4ge1xuICAgICAgICB0aGlzLnd0ZiA9IE9iamVjdC5hc3NpZ24oe30sIFsnZ2wtY2hhcnQnXSk7XG4gICAgICAgIHRoaXMud3RmWydnbC1jaGFydCddID0gZG9tLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2dsLWNoYXJ0Jyk7XG4gICAgICAgIHJldHVybiAoaSwgY2hhcnQsIGNpcmN1bGFySWQpID0+IHtcbiAgICAgICAgICBsZXQgcG9pbnRzID0gJyc7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGFydC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IGlkID0gKGNpcmN1bGFySWQgKyBpICsgMSkgJSBjaGFydC5sZW5ndGg7XG4gICAgICAgICAgICBpZiAoY2hhcnRbaWRdICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICBwb2ludHMgPSBwb2ludHMgKyAnICcgKyAoNTUgKiBpIC8gKGNoYXJ0Lmxlbmd0aCAtIDEpKS50b0ZpeGVkKDEpICsgJywnICsgKDQ2IC0gY2hhcnRbaWRdICogMjQgLyA2MCkudG9GaXhlZCgxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy53dGZbJ2dsLWNoYXJ0J11baV0uc2V0QXR0cmlidXRlKCdwb2ludHMnLCBwb2ludHMpO1xuICAgICAgICAgIGxvZ2dlcih0aGlzLm5hbWVzW2ldLCBjaGFydCwgY2lyY3VsYXJJZCk7XG4gICAgICAgIH1cbiAgICAgIH0pKHRoaXMuY2hhcnRMb2dnZXIsIHRoaXMuZG9tKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXhwbGljaXQgVUkgYWRkXG4gICAqIEBwYXJhbSB7IHN0cmluZyB8IHVuZGVmaW5lZCB9IG5hbWUgXG4gICAqL1xuICBhZGRVSShuYW1lKSB7XG4gICAgaWYgKHRoaXMubmFtZXMuaW5kZXhPZihuYW1lKSA9PSAtMSkge1xuICAgICAgdGhpcy5uYW1lcy5wdXNoKG5hbWUpO1xuICAgICAgaWYgKHRoaXMuZG9tKSB0aGlzLmRvbS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIHRoaXMuc3ZnKTtcbiAgICAgIHRoaXMuY3B1QWNjdW1zLnB1c2goMCk7XG4gICAgICB0aGlzLmdwdUFjY3Vtcy5wdXNoKDApO1xuICAgICAgdGhpcy5hY3RpdmVBY2N1bXMucHVzaChmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEluY3JlYXNlIGZyYW1lSURcbiAgICogQHBhcmFtIHsgbnVtYmVyIHwgdW5kZWZpbmVkIH0gbm93XG4gICAqL1xuICBuZXh0RnJhbWUobm93KSB7XG4gICAgdGhpcy5mcmFtZUlkKys7XG4gICAgY29uc3QgdCA9IG5vdyA/IG5vdyA6IHRoaXMubm93KCk7XG5cbiAgICAvLyB1cGRhdGUgcGFyYW1zXG4gICAgaWYgKHRoaXMuZnJhbWVJZCA8IDIpIHtcbiAgICAgIHRoaXMuZnJhbWVTdGFydCA9IHRoaXMuZnJhbWVJZDtcbiAgICAgIHRoaXMudGltZVN0YXJ0ID0gdDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZHVyYXRpb24gPSB0IC0gdGhpcy50aW1lU3RhcnQ7XG4gICAgICBpZiAoZHVyYXRpb24gPj0gMWUzKSB7XG4gICAgICAgIGNvbnN0IGZyYW1lQ291bnQgPSB0aGlzLmZyYW1lSWQgLSB0aGlzLmZyYW1lU3RhcnQ7XG4gICAgICAgIGNvbnN0IGZwcyA9IGZyYW1lQ291bnQgLyBkdXJhdGlvbiAqIDFlMztcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgY3B1ID0gdGhpcy5jcHVBY2N1bXNbaV0gLyBkdXJhdGlvbiAqIDEwMCxcbiAgICAgICAgICAgIGdwdSA9IHRoaXMuZ3B1QWNjdW1zW2ldIC8gZHVyYXRpb24gKiAxMDAsXG4gICAgICAgICAgICBtZW0gPSAocGVyZm9ybWFuY2UgJiYgcGVyZm9ybWFuY2UubWVtb3J5KSA/IHBlcmZvcm1hbmNlLm1lbW9yeS51c2VkSlNIZWFwU2l6ZSAvICgxIDw8IDIwKSA6IDA7XG4gICAgICAgICAgdGhpcy5wYXJhbUxvZ2dlcihpLCBjcHUsIGdwdSwgbWVtLCBmcHMsIGR1cmF0aW9uLCBmcmFtZUNvdW50KTtcbiAgICAgICAgICB0aGlzLmNwdUFjY3Vtc1tpXSA9IDA7XG4gICAgICAgICAgdGhpcy5ncHVBY2N1bXNbaV0gPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZnJhbWVTdGFydCA9IHRoaXMuZnJhbWVJZDtcbiAgICAgICAgdGhpcy50aW1lU3RhcnQgPSB0O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIHVwZGF0ZSBjaGFydFxuICAgIGlmICh0aGlzLmZyYW1lSWQgPCAyKSB7XG4gICAgICB0aGlzLmNpcmN1bGFySWQgPSAwO1xuICAgICAgdGhpcy5wcmV2RnJhbWUgPSB0aGlzLmZyYW1lSWQ7XG4gICAgICB0aGlzLnplcm90aW1lID0gdDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZHVyYXRpb24gPSB0IC0gdGhpcy56ZXJvdGltZTtcbiAgICAgIGxldCBoeiA9IDIwICogZHVyYXRpb24gLyAxZTM7XG4gICAgICB3aGlsZSAoLS1oeiA+IDApIHtcbiAgICAgICAgY29uc3QgZnJhbWVDb3VudCA9IHRoaXMuZnJhbWVJZCAtIHRoaXMucHJldkZyYW1lO1xuICAgICAgICBjb25zdCBmcHMgPSBmcmFtZUNvdW50IC8gZHVyYXRpb24gKiAxZTM7XG4gICAgICAgIHRoaXMuY2hhcnRbdGhpcy5jaXJjdWxhcklkICUgdGhpcy5jaGFydExlbl0gPSBmcHM7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uYW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuY2hhcnRMb2dnZXIoaSwgdGhpcy5jaGFydCwgdGhpcy5jaXJjdWxhcklkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNpcmN1bGFySWQrKztcbiAgICAgICAgdGhpcy5wcmV2RnJhbWUgPSB0aGlzLmZyYW1lSWQ7XG4gICAgICAgIHRoaXMuemVyb3RpbWUgPSB0O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBCZWdpbiBuYW1lZCBtZWFzdXJlbWVudFxuICAgKiBAcGFyYW0geyBzdHJpbmcgfCB1bmRlZmluZWQgfSBuYW1lXG4gICAqL1xuICBiZWdpbihuYW1lKSB7XG4gICAgdGhpcy51cGRhdGVBY2N1bXMobmFtZSk7XG4gIH1cblxuICAvKipcbiAgICogRW5kIG5hbWVkIG1lYXN1cmVcbiAgICogQHBhcmFtIHsgc3RyaW5nIHwgdW5kZWZpbmVkIH0gbmFtZVxuICAgKi9cbiAgZW5kKG5hbWUpIHtcbiAgICB0aGlzLnVwZGF0ZUFjY3VtcyhuYW1lKTtcbiAgfVxuXG4gIHVwZGF0ZUFjY3VtcyhuYW1lKSB7XG4gICAgbGV0IG5hbWVJZCA9IHRoaXMubmFtZXMuaW5kZXhPZihuYW1lKTtcbiAgICBpZiAobmFtZUlkID09IC0xKSB7XG4gICAgICBuYW1lSWQgPSB0aGlzLm5hbWVzLmxlbmd0aDtcbiAgICAgIHRoaXMuYWRkVUkobmFtZSk7XG4gICAgfVxuXG4gICAgY29uc3QgdCA9IHRoaXMubm93KCk7XG4gICAgY29uc3QgZHQgPSB0IC0gdGhpcy50MDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVJZCArIDE7IGkrKykge1xuICAgICAgaWYgKHRoaXMuYWN0aXZlQWNjdW1zW2ldKSB7XG4gICAgICAgIHRoaXMuY3B1QWNjdW1zW2ldICs9IGR0O1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5hY3RpdmVBY2N1bXNbbmFtZUlkXSA9ICF0aGlzLmFjdGl2ZUFjY3Vtc1tuYW1lSWRdO1xuICAgIHRoaXMudDAgPSB0O1xuICB9XG59Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFHZSxNQUFNLE9BQU8sQ0FBQzs7Ozs7O0VBTTNCLFdBQVcsQ0FBQyxFQUFFLEVBQUUsUUFBUSxHQUFHLEVBQUUsRUFBRTtJQUM3QixJQUFJLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQztJQUNqQixJQUFJLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQztJQUNqQixJQUFJLENBQUMsV0FBVyxHQUFHLE1BQU0sRUFBRSxDQUFDO0lBQzVC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
